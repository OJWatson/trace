<!DOCTYPE html>
<html lang="en"><head>
<script src="trace_talk_files/libs/clipboard/clipboard.min.js"></script>
<script src="trace_talk_files/libs/quarto-html/tabby.min.js"></script>
<script src="trace_talk_files/libs/quarto-html/popper.min.js"></script>
<script src="trace_talk_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="trace_talk_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="trace_talk_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="trace_talk_files/libs/quarto-html/quarto-syntax-highlighting-de84f8d6bb715db06a919283c2d1e787.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.42">

  <meta name="author" content="Imperial College London">
  <meta name="dcterms.date" content="2025-12-08">
  <title>TRACE</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="trace_talk_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="trace_talk_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href="trace_talk_files/libs/revealjs/dist/theme/quarto-a1be45f399f1d48d4b4883eb59d21459.css">
  <link href="trace_talk_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="trace_talk_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="trace_talk_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="trace_talk_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">TRACE</h1>
  <p class="subtitle">Temporal and Regional Analysis of Conflict Events</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Imperial College London 
</div>
        <p class="quarto-title-affiliation">
            In partnership with Médecins Sans Frontières
          </p>
    </div>
</div>

  <p class="date">2025-12-08</p>
</section>
<section id="the-problem" class="slide level2 smaller">
<h2>The Problem</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Partnership with Médecins Sans Frontières</strong></p>
</div>
<div class="callout-content">
<p><strong>MSF Gaza approached us with a critical operational question:</strong></p>
<blockquote>
<p><em>“During active conflict, can we produce short-term forecasts of hospital patient volumes and their typology of needs, so we can stock and staff in preparation?”</em></p>
</blockquote>
</div>
</div>
</div>
<h3 id="challenges-in-conflict-settings">Challenges in conflict settings:</h3>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><strong>Under-reporting</strong>: True tolls often exceed official figures</li>
<li><strong>Multiple incomplete data streams</strong>: Events, hospitals, mortality</li>
<li><strong>Spatial complexity</strong>: Casualties distributed across hospitals</li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li><strong>Temporal delays</strong>: Deaths occur days/weeks after injury</li>
<li><strong>Uncertainty quantification</strong>: Critical for resource planning</li>
<li><strong>Real-time needs</strong>: Operational decisions can’t wait</li>
</ul>
</div></div>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p><strong>Fitting targets available:</strong> National death toll, hospital patient volumes and needs over time</p>
</div>
</div>
</div>
</section>
<section id="existing-approaches" class="slide level2 smaller">
<h2>Existing Approaches</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="mechanistic-models">Mechanistic Models</h3>
<ul>
<li><strong>Lanchester equations</strong>: <span class="math inline">\(\frac{dN_1}{dt} = -\alpha_2 N_2\)</span></li>
<li>Agent-based simulations</li>
<li>Network models</li>
</ul>
<div class="fragment">
<p>✓ Interpretable<br>
✗ Hard to fit to data<br>
✗ Require unknown force sizes<br>
✗ No spatial structure</p>
</div>
</div><div class="column" style="width:50%;">
<h3 id="statistical-models">Statistical Models</h3>
<ul>
<li>ARIMA, GLMs</li>
<li>Machine learning / neural networks</li>
<li>Time series forecasting</li>
</ul>
<div class="fragment">
<p>✓ Flexible, good short-term<br>
✗ No mechanistic insight<br>
✗ Poor extrapolation<br>
✗ Can’t encode scenarios</p>
</div>
</div></div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p><strong>TRACE</strong>: Semi-mechanistic approach—explicit casualty generation process combined with principled statistical inference</p>
</div>
</div>
</div>
</section>
<section id="inspiration-covid-19-epidemic-models" class="slide level2 smaller">
<h2>Inspiration: COVID-19 Epidemic Models</h2>
<p>TRACE adapts the semi-mechanistic framework from Flaxman et al.&nbsp;(2020):</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Epidemiology</th>
<th>Conflict (TRACE)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Susceptible population</td>
<td>Population at risk</td>
</tr>
<tr class="even">
<td>Infections (<span class="math inline">\(R_t\)</span>)</td>
<td>Conflict events (intensity)</td>
</tr>
<tr class="odd">
<td>Hospitalizations</td>
<td>Hospital admissions</td>
</tr>
<tr class="even">
<td>Deaths (with delays)</td>
<td>Deaths (immediate + delayed)</td>
</tr>
<tr class="odd">
<td>Age-stratified contacts</td>
<td><strong>Spatial allocation to hospitals</strong></td>
</tr>
</tbody>
</table>
<div class="fragment">
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p><strong>Key difference:</strong> Conflict events are <em>exogenous</em> (driven by military operations), not self-propagating like infections. This simplifies the model—no renewal equation needed.</p>
</div>
</div>
</div>
</div>
</section>
<section id="the-trace-framework" class="slide level2 smaller">
<h2>The TRACE Framework</h2>
<div id="94dde01b" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="trace_talk_files/figure-revealjs/cell-3-output-1.png" class="quarto-figure quarto-figure-center" width="1137" height="465"></p>
</figure>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Three coupled components:</strong> Events → Spatial Allocation → Injuries ⇄ Deaths</p>
</div>
</section>
<section id="mathematical-formulation" class="slide level2 smaller">
<h2>Mathematical Formulation</h2>
<h3 id="observation-models">Observation Models</h3>
<p>Hospital injuries <span class="math inline">\(H_{t,j}\)</span> at hospital <span class="math inline">\(j\)</span> on day <span class="math inline">\(t\)</span>, and national deaths <span class="math inline">\(D_t\)</span>:</p>
<p><span class="math display">\[
H_{t,j} \sim \text{Poisson}(\lambda_{t,j}), \quad D_t \sim \text{Poisson}(\delta_t)
\]</span></p>
<h3 id="expected-injuries-spatial-allocation">Expected Injuries (Spatial Allocation)</h3>
<p><span class="math display">\[
\lambda_{t,j} = \mu_w \sum_{e \in E_t} w_{e,j}, \quad \text{where } w_{e,j} = \frac{\exp(-d_{e,j}/\ell)}{\sum_{j'} \exp(-d_{e,j'}/\ell)}
\]</span></p>
<ul>
<li><span class="math inline">\(\mu_w &gt; 0\)</span>: average wounded per event</li>
<li><span class="math inline">\(d_{e,j}\)</span>: distance from event <span class="math inline">\(e\)</span> to hospital <span class="math inline">\(j\)</span><br>
</li>
<li><span class="math inline">\(\ell &gt; 0\)</span>: spatial length scale (inferred)</li>
</ul>
<h3 id="expected-deaths-immediate-delayed">Expected Deaths (Immediate + Delayed)</h3>
<p><span class="math display">\[
\delta_t = \underbrace{\mu_i |E_t|}_{\text{immediate}} + \underbrace{p_{\text{late}} \sum_{k=1}^L I_{t-k} f_k}_{\text{delayed hospital deaths}}
\]</span></p>
</section>
<section id="the-delay-distribution" class="slide level2 smaller">
<h2>The Delay Distribution</h2>
<p>Deaths don’t occur immediately after injury—this temporal structure is critical:</p>
<div id="0f38b7a3" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="trace_talk_files/figure-revealjs/cell-4-output-1.png" class="quarto-figure quarto-figure-center" width="1039" height="368"></p>
</figure>
</div>
</div>
</div>
<p><span class="math display">\[
\text{Delayed deaths on day } t = p_{\text{late}} \sum_{k=1}^L I_{t-k} f_k
\]</span></p>
<p>Based on trauma literature: ~50% of hospital deaths within 24h, tail extends to weeks.</p>
</section>
<section id="prior-specifications" class="slide level2 smaller">
<h2>Prior Specifications</h2>
<p>Weakly informative priors balance regularization with data-driven inference:</p>
<table class="caption-top">
<colgroup>
<col style="width: 32%">
<col style="width: 20%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Prior</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\mu_w\)</span></td>
<td><span class="math inline">\(\text{Exp}(0.3)\)</span></td>
<td>Mean ~3.3 wounded per event</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mu_i\)</span></td>
<td><span class="math inline">\(\text{Exp}(0.3)\)</span></td>
<td>Mean ~3.3 immediate deaths per event</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(p_{\text{late}}\)</span></td>
<td><span class="math inline">\(\text{Beta}(2, 10)\)</span></td>
<td>Mean ~17% hospital fatality rate</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\ell\)</span></td>
<td><span class="math inline">\(\text{Exp}(1.0)\)</span></td>
<td>Mean ~1° (~100 km) spatial scale</td>
</tr>
</tbody>
</table>
<div class="fragment">
<div id="e91cca2e" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="trace_talk_files/figure-revealjs/cell-5-output-1.png" class="quarto-figure quarto-figure-center" width="1137" height="223"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="simulating-conflict-data" class="slide level2 smaller">
<h2>Simulating Conflict Data</h2>
<p>Let’s simulate a realistic 90-day conflict scenario:</p>
<div id="874858ce" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="im">from</span> trace.simulate <span class="im">import</span> simulate_conflict_data</span>
<span id="cb1-2"><a href=""></a></span>
<span id="cb1-3"><a href=""></a><span class="co"># True parameters</span></span>
<span id="cb1-4"><a href=""></a>TRUE_PARAMS <span class="op">=</span> {</span>
<span id="cb1-5"><a href=""></a>    <span class="st">'mu_w'</span>: <span class="fl">5.0</span>,      <span class="co"># Wounded per event</span></span>
<span id="cb1-6"><a href=""></a>    <span class="st">'mu_i'</span>: <span class="fl">1.5</span>,      <span class="co"># Immediate deaths per event  </span></span>
<span id="cb1-7"><a href=""></a>    <span class="st">'p_late'</span>: <span class="fl">0.20</span>,   <span class="co"># 20% hospital fatality rate</span></span>
<span id="cb1-8"><a href=""></a>    <span class="st">'ell'</span>: <span class="fl">15.0</span>,      <span class="co"># Spatial length scale</span></span>
<span id="cb1-9"><a href=""></a>}</span>
<span id="cb1-10"><a href=""></a>delay_probs <span class="op">=</span> np.array([<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.15</span>, <span class="fl">0.05</span>])</span>
<span id="cb1-11"><a href=""></a></span>
<span id="cb1-12"><a href=""></a><span class="co"># Simulate data</span></span>
<span id="cb1-13"><a href=""></a>sim_data <span class="op">=</span> simulate_conflict_data(</span>
<span id="cb1-14"><a href=""></a>    n_regions<span class="op">=</span><span class="dv">3</span>, n_hospitals<span class="op">=</span><span class="dv">5</span>, T<span class="op">=</span><span class="dv">90</span>,</span>
<span id="cb1-15"><a href=""></a>    mu_w_true<span class="op">=</span>TRUE_PARAMS[<span class="st">'mu_w'</span>],</span>
<span id="cb1-16"><a href=""></a>    mu_i_true<span class="op">=</span>TRUE_PARAMS[<span class="st">'mu_i'</span>],</span>
<span id="cb1-17"><a href=""></a>    p_late_true<span class="op">=</span>TRUE_PARAMS[<span class="st">'p_late'</span>],</span>
<span id="cb1-18"><a href=""></a>    delay_probs<span class="op">=</span>delay_probs,</span>
<span id="cb1-19"><a href=""></a>    ell_true<span class="op">=</span>TRUE_PARAMS[<span class="st">'ell'</span>],</span>
<span id="cb1-20"><a href=""></a>    events_rate<span class="op">=</span><span class="fl">3.0</span>,  <span class="co"># 3 events per day on average</span></span>
<span id="cb1-21"><a href=""></a>    seed<span class="op">=</span><span class="dv">42</span></span>
<span id="cb1-22"><a href=""></a>)</span>
<span id="cb1-23"><a href=""></a></span>
<span id="cb1-24"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Simulated </span><span class="sc">{</span><span class="bu">len</span>(sim_data[<span class="st">'events'</span>])<span class="sc">}</span><span class="ss"> events over 90 days"</span>)</span>
<span id="cb1-25"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Total injuries: </span><span class="sc">{</span>sim_data[<span class="st">'hospital_incidence'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-26"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Total deaths: </span><span class="sc">{</span>sim_data[<span class="st">'national_deaths'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulated 307 events over 90 days
Total injuries: 1505
Total deaths: 764</code></pre>
</div>
</div>
</section>
<section id="visualizing-simulated-data" class="slide level2 smaller">
<h2>Visualizing Simulated Data</h2>
<div id="26fe0ecc" class="cell" data-execution_count="6">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="trace_talk_files/figure-revealjs/cell-7-output-1.png" class="quarto-figure quarto-figure-center" width="1137" height="658"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="running-bayesian-inference" class="slide level2 smaller">
<h2>Running Bayesian Inference</h2>
<div id="6fc558de" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href=""></a><span class="im">from</span> trace.analysis <span class="im">import</span> run_inference</span>
<span id="cb3-2"><a href=""></a></span>
<span id="cb3-3"><a href=""></a><span class="co"># Prepare data for inference</span></span>
<span id="cb3-4"><a href=""></a>events_by_day <span class="op">=</span> np.array([<span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> e <span class="kw">in</span> sim_data[<span class="st">'events'</span>] <span class="cf">if</span> e[<span class="st">'date'</span>] <span class="op">==</span> d) <span class="cf">for</span> d <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">90</span>)])</span>
<span id="cb3-5"><a href=""></a>event_day_index <span class="op">=</span> np.array([e[<span class="st">'date'</span>] <span class="cf">for</span> e <span class="kw">in</span> sim_data[<span class="st">'events'</span>]])</span>
<span id="cb3-6"><a href=""></a>event_coords <span class="op">=</span> np.array([[e[<span class="st">'latitude'</span>], e[<span class="st">'longitude'</span>]] <span class="cf">for</span> e <span class="kw">in</span> sim_data[<span class="st">'events'</span>]])</span>
<span id="cb3-7"><a href=""></a></span>
<span id="cb3-8"><a href=""></a><span class="co"># Run MCMC (reduced samples for demo)</span></span>
<span id="cb3-9"><a href=""></a>mcmc, samples <span class="op">=</span> run_inference(</span>
<span id="cb3-10"><a href=""></a>    events_by_day<span class="op">=</span>events_by_day,</span>
<span id="cb3-11"><a href=""></a>    event_day_index<span class="op">=</span>event_day_index,</span>
<span id="cb3-12"><a href=""></a>    event_coords<span class="op">=</span>event_coords,</span>
<span id="cb3-13"><a href=""></a>    hospital_coords<span class="op">=</span>sim_data[<span class="st">'hospital_coords'</span>],</span>
<span id="cb3-14"><a href=""></a>    injuries_obs<span class="op">=</span>sim_data[<span class="st">'hospital_incidence'</span>],</span>
<span id="cb3-15"><a href=""></a>    deaths_obs<span class="op">=</span>sim_data[<span class="st">'national_deaths'</span>],</span>
<span id="cb3-16"><a href=""></a>    delay_probs<span class="op">=</span>delay_probs,</span>
<span id="cb3-17"><a href=""></a>    num_warmup<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb3-18"><a href=""></a>    num_samples<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb3-19"><a href=""></a>    num_chains<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb3-20"><a href=""></a>    rng_seed<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb3-21"><a href=""></a>    progress_bar<span class="op">=</span><span class="va">False</span></span>
<span id="cb3-22"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c5daf077" class="cell" data-execution_count="8">
<div class="cell-output cell-output-stdout">
<pre><code>MCMC completed. Checking parameter recovery...</code></pre>
</div>
</div>
</section>
<section id="parameter-recovery" class="slide level2 smaller">
<h2>Parameter Recovery</h2>
<p>Can we recover the true parameters from the simulated data?</p>
<div id="cd3418d4" class="cell" data-execution_count="9">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="trace_talk_files/figure-revealjs/cell-10-output-1.png" class="quarto-figure quarto-figure-center" width="1137" height="272"></p>
</figure>
</div>
</div>
</div>
<div id="7a2b30e6" class="cell" data-execution_count="10">
<div class="cell-output cell-output-stdout">
<pre><code>Parameter Recovery Summary:
--------------------------------------------------
mu_w      : True = 5.00, Post. mean = 4.90 [4.66, 5.16] ✓
mu_i      : True = 1.50, Post. mean = 1.53 [1.11, 1.90] ✓
p_late    : True = 0.20, Post. mean = 0.20 [0.12, 0.28] ✓
ell       : True = 15.00, Post. mean = 14.37 [13.18, 15.74] ✓</code></pre>
</div>
</div>
</section>
<section id="posterior-predictive-check" class="slide level2 smaller">
<h2>Posterior Predictive Check</h2>
<p>Does the model reproduce the observed data?</p>
<div id="2594130e" class="cell" data-execution_count="11">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="trace_talk_files/figure-revealjs/cell-12-output-1.png" class="quarto-figure quarto-figure-center" width="1137" height="370"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scenario-based-forecasting" class="slide level2 smaller">
<h2>Scenario-Based Forecasting</h2>
<p>What if we project 30 days under different scenarios?</p>
<div id="f59c2137" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href=""></a><span class="im">from</span> trace.analysis <span class="im">import</span> forecast</span>
<span id="cb6-2"><a href=""></a></span>
<span id="cb6-3"><a href=""></a>recent_rate <span class="op">=</span> np.mean(events_by_day[<span class="op">-</span><span class="dv">30</span>:])  <span class="co"># Recent average events/day</span></span>
<span id="cb6-4"><a href=""></a></span>
<span id="cb6-5"><a href=""></a><span class="co"># Scenario 1: Baseline (continue current rate)</span></span>
<span id="cb6-6"><a href=""></a>baseline <span class="op">=</span> forecast(samples, np.full(<span class="dv">30</span>, recent_rate), delay_probs)</span>
<span id="cb6-7"><a href=""></a></span>
<span id="cb6-8"><a href=""></a><span class="co"># Scenario 2: Ceasefire (90% reduction)</span></span>
<span id="cb6-9"><a href=""></a>ceasefire <span class="op">=</span> forecast(samples, np.full(<span class="dv">30</span>, recent_rate <span class="op">*</span> <span class="fl">0.1</span>), delay_probs)</span>
<span id="cb6-10"><a href=""></a></span>
<span id="cb6-11"><a href=""></a><span class="co"># Scenario 3: Escalation (50% increase)</span></span>
<span id="cb6-12"><a href=""></a>escalation <span class="op">=</span> forecast(samples, np.full(<span class="dv">30</span>, recent_rate <span class="op">*</span> <span class="fl">1.5</span>), delay_probs)</span>
<span id="cb6-13"><a href=""></a></span>
<span id="cb6-14"><a href=""></a><span class="bu">print</span>(<span class="ss">f"30-Day Projections (median deaths):"</span>)</span>
<span id="cb6-15"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Baseline:   </span><span class="sc">{</span>baseline[<span class="st">'deaths_median'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:.0f}</span><span class="ss">"</span>)</span>
<span id="cb6-16"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Ceasefire:  </span><span class="sc">{</span>ceasefire[<span class="st">'deaths_median'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:.0f}</span><span class="ss">"</span>)</span>
<span id="cb6-17"><a href=""></a><span class="bu">print</span>(<span class="ss">f"  Escalation: </span><span class="sc">{</span>escalation[<span class="st">'deaths_median'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:.0f}</span><span class="ss">"</span>)</span>
<span id="cb6-18"><a href=""></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Lives saved by ceasefire: </span><span class="sc">{</span>baseline[<span class="st">'deaths_median'</span>]<span class="sc">.</span><span class="bu">sum</span>() <span class="op">-</span> ceasefire[<span class="st">'deaths_median'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:.0f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>30-Day Projections (median deaths):
  Baseline:   179
  Ceasefire:  0
  Escalation: 270

Lives saved by ceasefire: 179</code></pre>
</div>
</div>
</section>
<section id="forecast-comparison" class="slide level2 smaller">
<h2>Forecast Comparison</h2>
<div id="93614f10" class="cell" data-execution_count="13">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="trace_talk_files/figure-revealjs/cell-14-output-1.png" class="quarto-figure quarto-figure-center" width="1041" height="465"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="hierarchical-extension" class="slide level2 smaller">
<h2>Hierarchical Extension</h2>
<p>For multi-region analysis, we can partially pool parameters:</p>
<p><span class="math display">\[
\begin{aligned}
\mu_{w,r} &amp;= \bar{\mu}_w \cdot \exp(\eta_r), \quad \eta_r \sim \mathcal{N}(0, \sigma_\mu^2) \\
\mu_{i,r} &amp;= \bar{\mu}_i \cdot \exp(\xi_r), \quad \xi_r \sim \mathcal{N}(0, \sigma_i^2) \\
p_{\text{late},r} &amp;\sim \text{Beta}(\alpha_0 + \gamma_r, \beta_0)
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(r\)</span> indexes regions/conflict zones.</p>
<div id="b922e9b2" class="cell" data-execution_count="14">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="trace_talk_files/figure-revealjs/cell-15-output-1.png" class="quarto-figure quarto-figure-center" width="751" height="370"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p><strong>Benefit:</strong> Regions with sparse data borrow strength from data-rich regions.</p>
</div>
</div>
</div>
</section>
<section id="extension-event-types-injury-types" class="slide level2 smaller">
<h2>Extension: Event Types → Injury Types</h2>
<p>ACLED encodes event types (airstrikes, shelling, armed clashes, etc.). Can these predict <strong>injury typology</strong>?</p>
<p><span class="math display">\[
\mu_{w,t} = \sum_{c \in \mathcal{C}} \beta_c \cdot \mathbb{1}[\text{event type} = c]
\]</span></p>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>MSF Operational Need</strong></p>
</div>
<div class="callout-content">
<p>Different event types may predict different patient needs:</p>
<table class="caption-top">
<colgroup>
<col style="width: 29%">
<col style="width: 46%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th>Event Type</th>
<th>Expected Injuries</th>
<th>Typology</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Airstrike</td>
<td>High casualty mass events</td>
<td>Burns, blast trauma, amputations</td>
</tr>
<tr class="even">
<td>Shelling</td>
<td>Moderate, clustered</td>
<td>Shrapnel wounds, crush injuries</td>
</tr>
<tr class="odd">
<td>Armed clash</td>
<td>Variable, combatants</td>
<td>Gunshot wounds</td>
</tr>
<tr class="even">
<td>Explosion</td>
<td>High severity</td>
<td>Blast injuries, TBI</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Research question:</strong> Is reported event type predictive of injury types after controlling for event intensity?</p>
</div>
</section>
<section id="acled-event-type-distribution" class="slide level2 smaller">
<h2>ACLED Event Type Distribution</h2>
<div id="15132bff" class="cell" data-execution_count="15">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="trace_talk_files/figure-revealjs/cell-16-output-1.png" class="quarto-figure quarto-figure-center" width="1137" height="365"></p>
</figure>
</div>
</div>
</div>
<p><strong>Extension:</strong> Fit <span class="math inline">\(\beta_c\)</span> for each event type to predict casualty counts and types.</p>
</section>
<section id="data-sources" class="slide level2 smaller">
<h2>Data Sources</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="input-data-streams">Input Data Streams</h3>
<ol type="1">
<li><strong>ACLED</strong> (<a href="https://acleddata.com">acleddata.com</a>)
<ul>
<li>Geo-coded conflict events</li>
<li>Date, location, type, actors</li>
<li>Reported fatalities</li>
</ul></li>
<li><strong>Hospital Records</strong> (MSF, MoH)
<ul>
<li>Patient volumes over time</li>
<li>Injury types and severity</li>
</ul></li>
<li><strong>Mortality Data</strong> (MoH, Tech for Palestine)
<ul>
<li>Daily/cumulative death tolls</li>
<li>Breakdown by demographics</li>
</ul></li>
</ol>
</div><div class="column" style="width:50%;">
<h3 id="gaza-context">Gaza Context</h3>
<ul>
<li><strong>ACLED</strong>: 27,815+ events (Oct 2023–present)</li>
<li><strong>Tech for Palestine API</strong>: Daily mortality</li>
<li><strong>MSF Hospital Data</strong>:
<ul>
<li>Patient volumes</li>
<li>Surgical cases</li>
<li>Typology of needs</li>
</ul></li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Real hospital data enables fitting—this is what MSF provides that makes the model operationally useful.</p>
</div>
</div>
</div>
</div></div>
</section>
<section id="implementation-stack" class="slide level2 smaller">
<h2>Implementation Stack</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="core-technologies">Core Technologies</h3>
<ul>
<li><strong>JAX</strong>: GPU-accelerated arrays, autodiff</li>
<li><strong>NumPyro</strong>: Probabilistic programming, NUTS</li>
<li><strong>ArviZ</strong>: Diagnostics &amp; visualization</li>
<li><strong>Python</strong>: Open-source package</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href=""></a><span class="ex">pip</span> install trace-conflict</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="width:50%;">
<h3 id="key-features">Key Features</h3>
<ul>
<li>NUTS sampler (adaptive HMC)</li>
<li>GPU acceleration via JAX</li>
<li>Hierarchical model support</li>
<li>Synthetic data generation</li>
<li>Scenario-based forecasting</li>
<li>Posterior predictive checks</li>
</ul>
<div class="fragment">
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href=""></a><span class="im">from</span> trace.analysis <span class="im">import</span> run_inference</span>
<span id="cb9-2"><a href=""></a>mcmc, samples <span class="op">=</span> run_inference(</span>
<span id="cb9-3"><a href=""></a>    events_by_day, event_coords,</span>
<span id="cb9-4"><a href=""></a>    hospital_coords, injuries_obs,</span>
<span id="cb9-5"><a href=""></a>    deaths_obs, delay_probs</span>
<span id="cb9-6"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</section>
<section id="applications-for-msf" class="slide level2 smaller">
<h2>Applications for MSF</h2>
<div>
<ol type="1">
<li class="fragment"><strong>Short-term forecasting (1-7 days)</strong>
<ul>
<li class="fragment">Predict patient volumes at specific hospitals</li>
<li class="fragment">Plan surgical team deployment</li>
<li class="fragment">Pre-position medical supplies</li>
</ul></li>
<li class="fragment"><strong>Typology prediction</strong> (extension)
<ul>
<li class="fragment">Anticipate injury types from event patterns</li>
<li class="fragment">Stock appropriate supplies (burn kits vs.&nbsp;trauma kits)</li>
</ul></li>
<li class="fragment"><strong>Scenario planning</strong>
<ul>
<li class="fragment">Quantify impact of ceasefire/escalation</li>
<li class="fragment">Inform advocacy with uncertainty-quantified projections</li>
</ul></li>
<li class="fragment"><strong>Resource optimization</strong>
<ul>
<li class="fragment">Optimal allocation across facilities</li>
<li class="fragment">Identify underserved geographic areas</li>
</ul></li>
<li class="fragment"><strong>Retrospective analysis</strong>
<ul>
<li class="fragment">Estimate true casualty burdens</li>
<li class="fragment">Evaluate intervention effectiveness</li>
</ul></li>
</ol>
</div>
</section>
<section id="limitations-future-work" class="slide level2 smaller">
<h2>Limitations &amp; Future Work</h2>
<h3 id="current-limitations">Current Limitations</h3>
<ul>
<li><strong>Data quality</strong>: All inference conditional on reporting accuracy</li>
<li><strong>Identifiability</strong>: Some parameters confounded (e.g., <span class="math inline">\(\mu_i\)</span> vs.&nbsp;<span class="math inline">\(p_{\text{late}}\)</span>)</li>
<li><strong>Indirect deaths</strong>: Model captures only direct casualties</li>
<li><strong>Static spatial structure</strong>: Doesn’t model hospital damage/closure</li>
</ul>
<h3 id="planned-extensions">Planned Extensions</h3>
<ul>
<li><strong>Time-varying parameters</strong>: <span class="math inline">\(\mu_{w,t}\)</span> with random walk priors</li>
<li><strong>Event-type regression</strong>: <span class="math inline">\(\beta_c\)</span> for injury type prediction</li>
<li><strong>Population displacement</strong>: Dynamic population at risk</li>
<li><strong>Self-exciting events</strong>: Endogenous conflict propagation</li>
<li><strong>Missing data imputation</strong>: Within model structure</li>
</ul>
</section>
<section id="summary" class="slide level2 smaller">
<h2>Summary</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>TRACE provides a principled framework for conflict casualty analysis</strong></p>
</div>
<div class="callout-content">
<ul>
<li><strong>Semi-mechanistic</strong>: Explicit casualty generation + statistical inference</li>
<li><strong>Multi-stream</strong>: Integrates events, hospital admissions, mortality</li>
<li><strong>Spatial</strong>: Distance-based allocation to hospitals</li>
<li><strong>Temporal</strong>: Delay distributions from injury to death</li>
<li><strong>Bayesian</strong>: Full uncertainty quantification</li>
<li><strong>Actionable</strong>: Scenario-based forecasting for operational planning</li>
</ul>
</div>
</div>
</div>
<h3 id="acknowledgments">Acknowledgments</h3>
<ul>
<li><strong>Médecins Sans Frontières</strong> — partnership and operational context</li>
<li><strong>ACLED &amp; Tech for Palestine</strong> — open data access</li>
<li><strong>Imperial College London</strong> — research support</li>
</ul>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p><strong>Contact:</strong> trace@imperial.ac.uk | <strong>Code:</strong> github.com/imperial-college/trace</p>
</div>
</div>
</div>
</div>
</section>
<section id="section" class="slide level2" data-background-color="#002147">
<h2></h2>
<div class="r-fit-text center">
<p><strong>Thank You</strong></p>
</div>
<div class="center" style="color: white; margin-top: 2em;">
<p>Questions?</p>
<p><br></p>
<p><em>TRACE: Temporal and Regional Analysis of Conflict Events</em></p>
<p>Imperial College London × Médecins Sans Frontières</p>
</div>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="https://www.imperial.ac.uk/ImageCropToolT4/imageTool/uploaded-images/Blue-on-white--tojpeg_1495792235526_x1.jpg" class="slide-logo"></p>
<div class="footer footer-default">
<p>TRACE: Semi-Mechanistic Bayesian Models for Conflict Casualty Analysis</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="trace_talk_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="trace_talk_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="trace_talk_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="trace_talk_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="trace_talk_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="trace_talk_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="trace_talk_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="trace_talk_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="trace_talk_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="trace_talk_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1200,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>